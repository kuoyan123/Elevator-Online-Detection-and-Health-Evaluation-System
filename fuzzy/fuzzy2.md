# TSK模糊系统技术文档

## 系统概述
本系统实现了基于混合学习策略的TSK(Takagi-Sugeno-Kang)型模糊推理系统，采用前件参数梯度下降与后件参数最小二乘法相结合的学习机制，适用于回归分析任务。

## 系统特性
- 支持多输入单输出(MISO)回归建模
- 混合学习策略加速收敛
- 自适应高斯隶属函数参数
- 规则权重动态调整机制

---

## 架构设计

### 类结构
| 属性/方法                | 类型       | 说明描述                   |
|--------------------------|------------|--------------------------|
| `n_rules`                | 整型       | 每条特征对应的模糊规则数量  |
| `antecedent_params`      | 列表       | 前件高斯函数参数存储结构   |
| `consequent_params`      | 矩阵       | 后件线性系数矩阵           |
| `fit()`                  | 方法       | 模型训练入口               |
| `predict()`              | 方法       | 预测接口                   |

### 数据处理流程
1. **前件计算层**：特征值模糊化处理
2. **规则推理层**：激活强度计算
3. **后件合成层**：线性组合输出
4. **解模糊层**：加权平均生成预测值

---

## 算法原理

### 模糊规则表达
第$/i$条规则形式化描述：


$$
R^i: \text{IF } (x_1 \text{ is } A_1^i) \land ... \land (x_n \text{ is } A_n^i) \\
\text{THEN } y^i = p_0^i + \sum_{k=1}^n p_k^i x_k
$$

### 混合学习机制
| 组件        | 优化方法     | 数学原理                   |
|-------------|--------------|--------------------------|
| 前件参数     | 梯度下降     | 误差反向传播              |
| 后件参数     | 最小二乘法   | 正规方程求解              |

### 参数更新公式
**后件参数更新**：
$$
P = (\Phi^T \Phi)^{-1} \Phi^T Y
$$
其中设计矩阵 $\Phi$ 包含规则激活强度与特征值的组合

**前件参数梯度**：
$$
\frac{\partial E}{\partial \mu_k^i} = \frac{2}{N} \sum (y_{pred}-y_{true}) \cdot \frac{\partial y_{pred}}{\partial \mu_k^i}
$$

---

## 使用指南

### 参数配置表
| 参数项          | 数据类型 | 推荐值域      | 作用说明                 |
|-----------------|----------|--------------|------------------------|
| 规则数量         | 整型     | [3, 10]      | 控制模型复杂度           |
| 学习率           | 浮点型   | (0.001, 0.1] | 影响参数收敛速度         |
| 训练轮次         | 整型     | ≥100         | 保证充分收敛             |

### 数据预处理建议
1. 特征标准化（Z-score归一化）
2. 异常值检测与处理
3. 训练集/测试集比例建议4:1
4. 输出值归一化（可选）

### 典型训练曲线
训练过程损失变化：
Epoch 0 Loss: 1520.64
Epoch 50 Loss: 86.32
Epoch 100 Loss: 3.17
Epoch 150 Loss: 0.09

---

## 性能优化

### 加速策略
1. **矩阵运算矢量化**：利用NumPy广播机制
2. **并行计算**：规则激活强度并行计算
3. **记忆化技术**：缓存重复计算结果

### 正则化方法
1. L2正则化项加入损失函数
2. 早停机制(Early Stopping)
3. 规则剪枝策略

---

## 应用场景

### 适用领域
- 工业过程控制
- 经济预测模型
- 传感器数据处理
- 复杂系统建模

### 限制条件
- 输入特征维度不宜过高(建议<15维)
- 训练样本量建议>500
- 对周期性数据需特殊处理

---

## 参考文献
1. Takagi T, Sugeno M. 模糊系统辨识理论, 1985
2. Wang Lixin. 模糊系统与神经网络, 清华大学出版社, 2003
3. Pedregosa F. Scikit-learn设计原理, JMLR 2011